<!DOCTYPE html>
<html>
	<head>
		
			<title>Protocol::HTTP2::Frame</title>
		
		<meta charset="UTF-8"/>
		<meta name="viewport" content="width=device-width, initial-scale=1"/>
		
		<link rel="icon" type="image/png" href="../../../../_static/icon.png"/>
		<link rel="stylesheet" href="../../../../_static/site.css" type="text/css" media="screen"/>
		
		<script src="../../../../_components/jquery/jquery.min.js"></script>
		<script src="../../../../_components/jquery-syntax/jquery.syntax.min.js"></script>
		<script src="../../../../_components/mermaid/mermaid.min.js"></script>
		
		<script src="../../../../_static/links.js"></script>
		
		<script type="text/javascript">
		//<![CDATA[
			jQuery(function($) {
				$.syntax();
			});
			
			let isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
			let config = {theme: 'light'};
			if (isDarkMode) config.theme = 'dark';
			else config.theme = 'forest';
			mermaid.initialize(config);
		//]]>
		</script>
	</head>

	<body>
		<header> › <a class="link" href="../../../../index.html">Project</a> › <a class="link" href="../../../index.html">Source</a></header>
		
		<main>
			
	<h1><code class="language-ruby">Protocol::HTTP2::Frame</code></h1>
	
		
	
	
	
	<section>
	<h2>Definitions</h2>
	
	<section id="Protocol::HTTP2::Frame::VALID_STREAM_ID"><h3><code class="language-ruby">VALID_STREAM_ID = 0..0x7fffffff</code></h3><p>Stream Identifier cannot be bigger than this:
https://http2.github.stream/http2-spec/#rfc.section.4.1</p>
</section><section id="Protocol::HTTP2::Frame::VALID_LENGTH"><h3><code class="language-ruby">VALID_LENGTH = 0..0xffffff</code></h3><p>The absolute maximum bounds for the length field:</p>
</section><section id="Protocol::HTTP2::Frame::LENGTH_HISHIFT"><h3><code class="language-ruby">LENGTH_HISHIFT = 16</code></h3><p>Used for generating 24-bit frame length:</p>
</section><section id="Protocol::HTTP2::Frame#initialize"><h3><code class="language-ruby">def initialize(stream_id = 0, flags = 0, type = self.class::TYPE, length = nil, payload = nil)</code></h3><details>
						<summary><h4>Implementation</h4></summary>
						<pre><code class="language-ruby">def initialize(stream_id = 0, flags = 0, type = self.class::TYPE, length = nil, payload = nil)
	@length = length
	@type = type
	@flags = flags
	@stream_id = stream_id
	@payload = payload
end</code></pre>
					</details></section><section id="Protocol::HTTP2::Frame#connection?"><h3><code class="language-ruby">def connection?</code></h3><p>Check if frame is a connection frame: SETTINGS, PING, GOAWAY, and any
frame addressed to stream ID = 0.</p>
<details>
						<summary><h4>Implementation</h4></summary>
						<pre><code class="language-ruby">def connection?
	@stream_id.zero?
end</code></pre>
					</details></section><section id="Protocol::HTTP2::Frame#header"><h3><code class="language-ruby">def header</code></h3><p>Generates common 9-byte frame header.</p>
<ul>
<li>http://tools.ietf.org/html/draft-ietf-httpbis-http2-16#section-4.1</li>
</ul>
<details>
						<summary><h4>Implementation</h4></summary>
						<pre><code class="language-ruby">def header
	unless VALID_LENGTH.include? @length
		raise ProtocolError, &quot;Invalid frame size: #{@length.inspect}&quot;
	end
	
	unless VALID_STREAM_ID.include? @stream_id
		raise ProtocolError, &quot;Invalid stream identifier: #{@stream_id.inspect}&quot;
	end
	
	[
		# These are guaranteed correct due to the length check above.
		@length &gt;&gt; LENGTH_HISHIFT,
		@length &amp; LENGTH_LOMASK,
		@type,
		@flags,
		@stream_id
	].pack(HEADER_FORMAT)
end</code></pre>
					</details></section><section id="Protocol::HTTP2::Frame.parse_header"><h3><code class="language-ruby">def self.parse_header(buffer)</code></h3><p>Decodes common 9-byte header.</p>
<details>
						<summary><h4>Implementation</h4></summary>
						<pre><code class="language-ruby">def self.parse_header(buffer)
	length_hi, length_lo, type, flags, stream_id = buffer.unpack(HEADER_FORMAT)
	length = (length_hi &lt;&lt; LENGTH_HISHIFT) | length_lo
	stream_id = stream_id &amp; STREAM_ID_MASK
	
	# puts &quot;parse_header: length=#{length} type=#{type} flags=#{flags} stream_id=#{stream_id}&quot;
	
	return length, type, flags, stream_id
end</code></pre>
					</details></section>	</section>
	
	

				
			<footer>Documentation generated by <a href="https://github.com/socketry/utopia-project">Utopia::Project</a>.</footer>
		</main>
	</body>
</html>

